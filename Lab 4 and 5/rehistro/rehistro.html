<div class="page-wrap" [class.dark]="darkMode" [class.light]="!darkMode">

  <!-- ── Header ───────────────────────────────────────────────────────────── -->
  <header class="top-bar">
    <div class="brand">
      <mat-icon class="brand-icon">edit_note</mat-icon>
      <span class="brand-name">Re<span class="accent">histro</span></span>
    </div>
    <div class="theme-toggle-wrap">
      <mat-icon class="theme-icon">light_mode</mat-icon>
      <mat-slide-toggle
        [(ngModel)]="darkMode"
        color="accent"
        class="theme-toggle"
        matTooltip="Toggle light / dark mode">
      </mat-slide-toggle>
      <mat-icon class="theme-icon">dark_mode</mat-icon>
    </div>
  </header>

  <!-- ── Hero ─────────────────────────────────────────────────────────────── -->
  <div class="hero">
    <p class="hero-eyebrow">User Registration</p>
    <h1 class="hero-title">Create your <span class="accent">Account</span></h1>
    <p class="hero-sub">Fill in your details below to get started</p>
  </div>

  <!-- ── Form Card ─────────────────────────────────────────────────────────── -->
  <div class="form-card">
    <form [formGroup]="formdata" (ngSubmit)="onSubmit()" class="form-body">

      <!-- Full Name -->
      <mat-form-field appearance="outline" class="field-full">
        <mat-label>Full Name</mat-label>
        <mat-icon matPrefix>person</mat-icon>
        <input matInput formControlName="fullName" placeholder="Jane Smith">
        @if (formdata.controls['fullName'].invalid && formdata.controls['fullName'].touched) {
          <mat-error>Full name is required (min 2 characters).</mat-error>
        }
      </mat-form-field>

      <!-- Email -->
      <mat-form-field appearance="outline" class="field-full">
        <mat-label>Email Address</mat-label>
        <mat-icon matPrefix>email</mat-icon>
        <input matInput type="email" formControlName="email" placeholder="jane@example.com">
        @if (formdata.controls['email'].invalid && formdata.controls['email'].touched) {
          <mat-error>A valid email address is required.</mat-error>
        }
      </mat-form-field>

      <!-- Password -->
      <mat-form-field appearance="outline" class="field-full">
        <mat-label>Password</mat-label>
        <mat-icon matPrefix>lock</mat-icon>
        <input matInput type="password" formControlName="password" placeholder="Min 8 chars, starts with a letter">
        <mat-hint>Alphanumeric only · must start with a letter · min 8 characters</mat-hint>
        @if (passwordErrors) {
          <mat-error>{{ passwordErrors }}</mat-error>
        }
      </mat-form-field>

      <!-- Two-col row: Birth Date + Gender -->
      <div class="two-col">

        <!-- Birth Date -->
        <mat-form-field appearance="outline">
          <mat-label>Date of Birth</mat-label>
          <mat-icon matPrefix>cake</mat-icon>
          <input matInput [matDatepicker]="picker"
                 formControlName="birthDate"
                 [max]="maxDate"
                 placeholder="MM/DD/YYYY">
          <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-datepicker #picker startView="multi-year"></mat-datepicker>
          <mat-hint>Must be born in 2006 or earlier</mat-hint>
          @if (birthDateErrors) {
            <mat-error>{{ birthDateErrors }}</mat-error>
          }
        </mat-form-field>

        <!-- Gender -->
        <div class="radio-block">
          <label class="field-label">Gender</label>
          <mat-radio-group formControlName="gender" class="radio-col">
            <mat-radio-button value="male">Male</mat-radio-button>
            <mat-radio-button value="female">Female</mat-radio-button>
            <mat-radio-button value="nonbinary">Non-binary</mat-radio-button>
            <mat-radio-button value="prefer_not">Prefer not to say</mat-radio-button>
          </mat-radio-group>
          @if (formdata.controls['gender'].invalid && formdata.controls['gender'].touched) {
            <div class="inline-error">Please select a gender option.</div>
          }
        </div>

      </div>

      <!-- Address -->
      <mat-form-field appearance="outline" class="field-full">
        <mat-label>Address <span class="optional">(Optional)</span></mat-label>
        <mat-icon matPrefix>home</mat-icon>
        <input matInput formControlName="address" placeholder="123 Main St, City">
      </mat-form-field>

      <!-- Skill Level Slider -->
      <div class="slider-block">
        <label class="field-label">
          Angular Skill Level &nbsp;
          <span class="skill-badge">{{ formdata.get('angularSkillLevel')?.value }} / 10</span>
        </label>
        <mat-slider [min]="1" [max]="10" [step]="1" [discrete]="true" class="skill-slider">
          <input matSliderThumb formControlName="angularSkillLevel">
        </mat-slider>
        <div class="slider-hints">
          <span>Beginner</span><span>Intermediate</span><span>Expert</span>
        </div>
      </div>

      <!-- Submit Button -->
      <button
        mat-raised-button
        color="primary"
        type="submit"
        [disabled]="loading"
        class="btn-submit">
        @if (loading) {
          Submitting…
        } @else {
          Submit &nbsp;<mat-icon>send</mat-icon>
        }
      </button>

      <!-- Progress Bar -->
      @if (loading) {
        <mat-progress-bar mode="indeterminate" class="progress-bar"></mat-progress-bar>
      }

      <!-- Result Card -->
      @if (submitted) {
        <mat-divider class="result-divider"></mat-divider>
        <div class="result-card">
          <div class="result-header">
            <mat-icon class="result-check">check_circle</mat-icon>
            <span>Registered Successfully</span>
          </div>
          <div class="result-grid">
            <div class="result-item">
              <span class="result-label">Full Name</span>
              <span class="result-value">{{ result.fullName }}</span>
            </div>
            <div class="result-item">
              <span class="result-label">Email</span>
              <span class="result-value">{{ result.email }}</span>
            </div>
            <div class="result-item">
              <span class="result-label">Password</span>
              <span class="result-value">{{ result.password }}</span>
            </div>
            <div class="result-item">
              <span class="result-label">Birth Date</span>
              <span class="result-value">{{ result.birthDate | date:'mediumDate' }}</span>
            </div>
            <div class="result-item">
              <span class="result-label">Gender</span>
              <span class="result-value">{{ result.gender | titlecase }}</span>
            </div>
            @if (result.address) {
              <div class="result-item full-row">
                <span class="result-label">Address</span>
                <span class="result-value">{{ result.address }}</span>
              </div>
            }
            <div class="result-item">
              <span class="result-label">Angular Skill</span>
              <span class="result-value">{{ result.angularSkillLevel }} / 10</span>
            </div>
          </div>
        </div>
      }

    </form>
  </div>

  <footer class="footer">
    <mat-icon>edit_note</mat-icon> Rehistro &nbsp;·&nbsp; Built with Angular Material
  </footer>

</div>
